<!doctype html>

<html>

<head>
    <title>Test Fretboard Page</title>
    <meta name="viewport" content="initial-scale=1">
    <script src="./jquery-1.11.2.min.js"></script>
    <!-- To animate background colors -->
    <script src="./jquery.color-2.1.2.min.js"></script>
    <script src="./fretboard.js"></script>
    <link rel="stylesheet" type="text/css" href="./styles.css">
</head>

<body>
    <style>
    .container {
        min-width: 280px;
        max-width: 1600px;
        min-height: 600px;
        padding: 20px;
        overflow-x: hidden;
        background: lightgray;
    }
    
    button {
        margin: 20px 2px;
    }
    </style>
    <div class="container">
        <div class="my-fretboard-js"></div>
        
        <div class="my-fretboard-js space-theme"></div>
        
        <button class="toggle-chord-mode">Toggle chord mode</button>
        <button class="set-clicked-notes">Set C maj7 chord</button>
        <button class="get-clicked-notes">Get clicked notes (console)</button>
        <button class="note-clicking-disabled">Disable/enable note clicking</button>
        <button class="add-string">Add string</button>
        <button class="remove-string">Remove string</button>
        <button class="remove-fret">Remove fret</button>
        <button class="add-fret">Add fret</button>
    <!-- <button ng-click="unclick()">Unclick Frets</button>
    <button ng-click="addString()">Add String</button>
    <button ng-click="removeString()">Remove String</button>
    <button ng-click="toggleNoteClicking()">Toggle Note Clicking Allowed</button>
    <button ng-click="toggleTuningClicking()">Toggle Tuning Arrows Allowed</button>
    <button ng-click="toggleChordMode()">Toggle chord mode</button>
    <button ng-click="getClickedNotes()">Get clicked notes (console)</button> -->
    </div>
    <script type="text/javascript">
        (function($) {
            var isChordMode = true,
                isDisabled = false,
                tuning = [{
                        letter: "E",
                        octave: 4
                    }, {
                        letter: "B",
                        octave: 3
                    }, {
                        letter: "G",
                        octave: 3
                    }, {
                        letter: "D",
                        octave: 3
                    }, {
                        letter: "A",
                        octave: 2
                    }, {
                        letter: "E",
                        octave: 2
                    }],
                numFrets = 16,
                clickedNotes = [{
                    stringItsOn: {
                        letter: "E",
                        octave: 4
                    },
                    fretNumber: 3
                },{
                    stringItsOn: {
                        letter: "B",
                        octave: 3
                    },
                    fretNumber: 5
                }, {
                    stringItsOn: {
                        letter: "G",
                        octave: 3
                    },
                    fretNumber: 4
                }, {
                    stringItsOn: {
                        letter: "D",
                        octave: 3
                    },
                    fretNumber: 5
                }, {
                    stringItsOn: {
                        letter: "A",
                        octave: 2
                    },
                    fretNumber: 3
                }],
                dimensionsFunc = function() {
                    // "this" will be the options object into which we place this function
                    var options = this,
                        winWidth = $(window).width();
                        
                        if (winWidth >= 900) {
                            width = winWidth - 100;
                        } else {
                            width = 800;
                        }
            
                    return {
                        // half the width per fret, times number of strings
                        //((width / (this.numFrets + 1)) / 2) * this.tuning.length,
                        height: width / 5, 
                        width: width
                    };
                },
                options = {
                    allNoteLetters: ["C", "C#/Db", "D", "D#/Eb", "E", "F", "F#/Gb", "G", "Ab/G#", "A", "A#/Bb", "B"],
                    tuning: tuning,
                    numFrets: numFrets,
                    isChordMode: isChordMode,
                    noteClickingDisabled: isDisabled,
                    dimensionsFunc: dimensionsFunc,
                    animationSpeed: 500, // ms


                    /* old settings from the svg fretboard */
                    tuningClickingDisabled: false,
                    fretsToDrawOneCircleOn: [3, 5, 7, 9, 12],
                    showTuningTriangles: true,
                    showTuningSquares: true
                },
                $fretboard = $(".my-fretboard-js");
            
            $fretboard.fretboard(options); 
            
            $(".toggle-chord-mode").on("click", function() {
                isChordMode = !isChordMode;
                
                $fretboard.each(function() {
                    $(this).data('fretboard').setChordMode(isChordMode);
                });
            });
            
            $(".set-clicked-notes").on("click", function() {
                $fretboard.each(function() {
                    $(this).data('fretboard').setClickedNotes(clickedNotes);
                });
            });
            
            $(".get-clicked-notes").on("click", function() {
                $fretboard.each(function() {
                    console.log($(this).data('fretboard').getClickedNotes());
                });
                
            });
            
            $(".note-clicking-disabled").on("click", function() {
                isDisabled = !isDisabled;
                
                $fretboard.each(function() {
                    $(this).data('fretboard').setNoteClickingDisabled(isDisabled);
                });
            });
            
            $(".remove-string").on("click", function() {
                tuning.pop();
                // tuning.pop();
                
                $fretboard.each(function() {
                    $(this).data('fretboard').setTuning(tuning);
                });
            });
            
            $(".add-string").on("click", function() {
                if (tuning.length) {
                    tuning.push({
                        letter: tuning[tuning.length - 1].letter,
                        octave: tuning[tuning.length - 1].octave - 1
                    });
                    
                    /*tuning.push({
                        letter: tuning[tuning.length - 1].letter,
                        octave: tuning[tuning.length - 1].octave - 1
                    });*/
                } else {
                    tuning.push({
                        letter: "E",
                        octave: 4
                    });
                    
                    /*tuning.push({
                        letter: "B",
                        octave: 3
                    });*/
                }
                
                $fretboard.each(function() {
                    $(this).data('fretboard').setTuning(tuning);
                });
            });
            
            $(".remove-fret").on("click", function() {
                numFrets--;
                //numFrets--;
                
                $fretboard.each(function() {
                    $(this).data('fretboard').setNumFrets(numFrets);
                });
            });
            
            $(".add-fret").on("click", function() {
                numFrets++;
                //numFrets++;
                
                $fretboard.each(function() {
                    $(this).data('fretboard').setNumFrets(numFrets);
                });
            });
        })(jQuery);
    </script>
</body>

</html>
